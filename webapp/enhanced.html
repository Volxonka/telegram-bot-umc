<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#2c5aa0">
    <title>–£–ú–¶ - –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ú–∏—Ä–æ–≤—ã—Ö –¶–∏–≤–∏–ª–∏–∑–∞—Ü–∏–π</title>
    <link rel="stylesheet" href="enhanced-styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // Fallback for browsers that don't support Telegram WebApp
        if (!window.Telegram) {
            window.Telegram = {
                WebApp: {
                    ready: function() {},
                    expand: function() {},
                    initDataUnsafe: {},
                    showAlert: function(msg) { alert(msg); },
                    BackButton: {
                        show: function() {},
                        hide: function() {},
                        onClick: function() {}
                    },
                    onEvent: function() {}
                }
            };
        }
    </script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-container">
            <div class="loading-logo">
                <div class="logo-icon">üéì</div>
                <div class="logo-text">–£–ú–¶</div>
            </div>
            <div class="loading-spinner">
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
            </div>
            <div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...</div>
            <div class="loading-progress">
                <div class="progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app" class="app-container" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo">
                        <div class="logo-icon">üéì</div>
                        <div class="logo-text">
                            <h1>–£–ú–¶</h1>
                            <p>–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ú–∏—Ä–æ–≤—ã—Ö –¶–∏–≤–∏–ª–∏–∑–∞—Ü–∏–π</p>
                        </div>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="theme-toggle" onclick="toggleTheme()" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                        <i class="fas fa-moon" id="theme-icon"></i>
                    </button>
                    <button class="notification-btn" onclick="toggleNotifications()" title="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notification-count">3</span>
                    </button>
                    <div class="user-profile" onclick="toggleUserMenu()">
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="user-info">
                            <span class="user-name" id="user-name">–¢–µ—Å—Ç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                            <span class="user-role" id="user-role">–°—Ç—É–¥–µ–Ω—Ç</span>
                            <span class="user-group" id="user-group">üë• –ì—Ä—É–ø–ø–∞ –ñ1</span>
                        </div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
            </div>
        </header>

        <!-- User Menu Dropdown -->
        <div id="user-menu" class="user-menu" style="display: none;">
            <div class="menu-item" onclick="showProfile()">
                <i class="fas fa-user"></i>
                <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
            </div>
            <div class="menu-item" onclick="showSettings()">
                <i class="fas fa-cog"></i>
                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </div>
            <div class="menu-item" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>–í—ã–π—Ç–∏</span>
            </div>
        </div>

        <!-- Search Bar -->
        <div class="search-container">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º, –≤–æ–ø—Ä–æ—Å–∞–º...">
                <button class="search-clear" onclick="clearSearch()" style="display: none;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                <button class="filter-btn" data-filter="today">–°–µ–≥–æ–¥–Ω—è</button>
                <button class="filter-btn" data-filter="week">–ù–µ–¥–µ–ª—è</button>
                <button class="filter-btn" data-filter="important">–í–∞–∂–Ω–æ–µ</button>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs" id="nav-tabs">
            <button class="nav-tab active" data-tab="dashboard">
                <i class="fas fa-home"></i>
                <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="nav-tab" data-tab="schedule">
                <i class="fas fa-calendar-alt"></i>
                <span>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span>
            </button>
            <button class="nav-tab" data-tab="announcements">
                <i class="fas fa-bullhorn"></i>
                <span>–û–±—ä—è–≤–ª–µ–Ω–∏—è</span>
            </button>
            <button class="nav-tab" data-tab="polls">
                <i class="fas fa-poll"></i>
                <span>–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è</span>
            </button>
            <button class="nav-tab" data-tab="questions">
                <i class="fas fa-question-circle"></i>
                <span>–í–æ–ø—Ä–æ—Å—ã</span>
            </button>
        </nav>
        
        <!-- Mobile Navigation Indicator -->
        <div class="mobile-nav-indicator" id="mobile-nav-indicator"></div>

        <!-- Content Areas -->
        <main class="main-content">
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content active">
                <div class="dashboard-grid">
                    <!-- Quick Stats -->
                    <div class="stats-card">
                        <div class="stats-header">
                            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-number">5</div>
                                <div class="stat-label">–ü–∞—Ä —Å–µ–≥–æ–¥–Ω—è</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number">3</div>
                                <div class="stat-label">–ù–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number">1</div>
                                <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number">2</div>
                                <div class="stat-label">–ù–µ–æ—Ç–≤–µ—á–µ–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                            </div>
                        </div>
                    </div>

                    <!-- Today's Schedule -->
                    <div class="schedule-card">
                        <div class="card-header">
                            <h3>üìÖ –°–µ–≥–æ–¥–Ω—è—à–Ω–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h3>
                            <button class="refresh-btn" onclick="refreshTodaySchedule()">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        <div class="schedule-list" id="today-schedule">
                            <div class="schedule-item">
                                <div class="time">09:00</div>
                                <div class="subject">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</div>
                                <div class="room">–ê—É–¥. 101</div>
                                <div class="status present">–ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é</div>
                            </div>
                            <div class="schedule-item">
                                <div class="time">10:45</div>
                                <div class="subject">–§–∏–∑–∏–∫–∞</div>
                                <div class="room">–ê—É–¥. 203</div>
                                <div class="status absent">–û—Ç—Å—É—Ç—Å—Ç–≤—É—é</div>
                            </div>
                            <div class="schedule-item">
                                <div class="time">13:00</div>
                                <div class="subject">–•–∏–º–∏—è</div>
                                <div class="room">–õ–∞–±. 15</div>
                                <div class="status pending">–û–∂–∏–¥–∞–µ—Ç</div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Announcements -->
                    <div class="announcements-card">
                        <div class="card-header">
                            <h3>üì¢ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h3>
                            <button class="view-all-btn" onclick="switchTab('announcements')">
                                –í—Å–µ <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                        <div class="announcements-list" id="recent-announcements">
                            <div class="announcement-item important">
                                <div class="announcement-icon">üö®</div>
                                <div class="announcement-content">
                                    <div class="announcement-title">–í–∞–∂–Ω–æ–µ —Å–æ–±—Ä–∞–Ω–∏–µ</div>
                                    <div class="announcement-time">2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥</div>
                                </div>
                            </div>
                            <div class="announcement-item">
                                <div class="announcement-icon">üìù</div>
                                <div class="announcement-content">
                                    <div class="announcement-title">–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ</div>
                                    <div class="announcement-time">5 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="actions-card">
                        <div class="card-header">
                            <h3>‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                        </div>
                        <div class="actions-grid">
                            <button class="action-btn" onclick="askQuickQuestion()">
                                <i class="fas fa-question"></i>
                                <span>–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å</span>
                            </button>
                            <button class="action-btn" onclick="viewAttendance()">
                                <i class="fas fa-user-check"></i>
                                <span>–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</span>
                            </button>
                            <button class="action-btn" onclick="viewGrades()">
                                <i class="fas fa-graduation-cap"></i>
                                <span>–û—Ü–µ–Ω–∫–∏</span>
                            </button>
                            <button class="action-btn" onclick="viewCalendar()">
                                <i class="fas fa-calendar"></i>
                                <span>–ö–∞–ª–µ–Ω–¥–∞—Ä—å</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Schedule Tab -->
            <div id="schedule-tab" class="tab-content">
                <div class="content-header">
                    <h2><i class="fas fa-calendar-alt"></i> –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h2>
                    <div class="header-actions">
                        <button class="btn-secondary" onclick="exportSchedule()">
                            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç
                        </button>
                        <button class="btn-primary" onclick="refreshSchedule()">
                            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
                <div class="schedule-content" id="schedule-content">
                    <!-- Schedule content will be loaded here -->
                </div>
            </div>

            <!-- Announcements Tab -->
            <div id="announcements-tab" class="tab-content">
                <div class="content-header">
                    <h2><i class="fas fa-bullhorn"></i> –û–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
                    <div class="header-actions">
                        <button class="btn-secondary" onclick="markAllRead()">
                            <i class="fas fa-check-double"></i> –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ
                        </button>
                        <button class="btn-primary" onclick="refreshAnnouncements()">
                            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
                <div class="announcements-content" id="announcements-content">
                    <!-- Announcements content will be loaded here -->
                </div>
            </div>

            <!-- Polls Tab -->
            <div id="polls-tab" class="tab-content">
                <div class="content-header">
                    <h2><i class="fas fa-poll"></i> –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è</h2>
                    <div class="header-actions">
                        <button class="btn-secondary" onclick="viewPollHistory()">
                            <i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è
                        </button>
                        <button class="btn-primary" onclick="refreshPolls()">
                            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
                <div class="polls-content" id="polls-content">
                    <!-- Polls content will be loaded here -->
                </div>
            </div>

            <!-- Questions Tab -->
            <div id="questions-tab" class="tab-content">
                <div class="content-header">
                    <h2><i class="fas fa-question-circle"></i> –í–æ–ø—Ä–æ—Å—ã</h2>
                    <div class="header-actions">
                        <button class="btn-secondary" onclick="viewQuestionHistory()">
                            <i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è
                        </button>
                        <button class="btn-primary" onclick="refreshQuestions()">
                            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
                <div class="questions-content" id="questions-content">
                    <!-- Questions content will be loaded here -->
                </div>
            </div>
        </main>

        <!-- Floating Action Button -->
        <div class="fab-container">
            <button class="fab" onclick="toggleFabMenu()">
                <i class="fas fa-plus" id="fab-icon"></i>
            </button>
            <div class="fab-menu" id="fab-menu">
                <button class="fab-item" onclick="openScheduleForm()">
                    <i class="fas fa-calendar-plus"></i>
                    <span>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span>
                </button>
                <button class="fab-item" onclick="openAnnouncementForm()">
                    <i class="fas fa-bullhorn"></i>
                    <span>–û–±—ä—è–≤–ª–µ–Ω–∏–µ</span>
                </button>
                <button class="fab-item" onclick="openPollForm()">
                    <i class="fas fa-poll"></i>
                    <span>–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</span>
                </button>
                <button class="fab-item" onclick="openQuestionForm()">
                    <i class="fas fa-question"></i>
                    <span>–í–æ–ø—Ä–æ—Å</span>
                </button>
            </div>
        </div>

        <!-- Notification Panel -->
        <div id="notification-panel" class="notification-panel" style="display: none;">
            <div class="notification-header">
                <h3>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                <button class="close-btn" onclick="toggleNotifications()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="notification-list" id="notification-list">
                <div class="notification-item unread">
                    <div class="notification-icon">üìÖ</div>
                    <div class="notification-content">
                        <div class="notification-title">–ù–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>
                        <div class="notification-text">–î–æ–±–∞–≤–ª–µ–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –∑–∞–≤—Ç—Ä–∞</div>
                        <div class="notification-time">5 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥</div>
                    </div>
                </div>
                <div class="notification-item">
                    <div class="notification-icon">üì¢</div>
                    <div class="notification-content">
                        <div class="notification-title">–ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</div>
                        <div class="notification-text">–í–∞–∂–Ω–æ–µ —Å–æ–±—Ä–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã</div>
                        <div class="notification-time">1 —á–∞—Å –Ω–∞–∑–∞–¥</div>
                    </div>
                </div>
                <div class="notification-item">
                    <div class="notification-icon">üó≥</div>
                    <div class="notification-content">
                        <div class="notification-title">–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                        <div class="notification-text">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã</div>
                        <div class="notification-time">2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div id="modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modal-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h3>
                    <button class="modal-close" onclick="closeModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="modal-form"></div>
                </div>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toast-container" class="toast-container"></div>
    </div>

    <script src="enhanced-app.js"></script>
</body>
</html>
